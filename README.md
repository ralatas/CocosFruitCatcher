# Fruit Catcher (Cocos Creator 3.8, TS, ECS)

Аркада «Поймай падающие фрукты» на **Cocos Creator 3.8** и **TypeScript** с лёгким ECS. Корзина ловит фрукты, избегает хазардов, есть звуки, анимации попаданий и всплывающие очки с бонусом за серию.

---

## Быстрый старт

1) Откройте проект в **Cocos Creator 3.8**.
---

## Архитектура и ключевые системы

- `GameRoot` — композиция: создаёт состояния, системы, спавнит корзину, передаёт события в UI.
- `GameState` — счёт, жизни, таймер, завершение игры с причиной (`time_up` / `out_of_lives`).
- `world.ts` — простой ECS-мир и готовые `queries`.

Системы (`assets/scripts/core/ecs/systems/`):
- `BasketSpawner` — создание корзины и регистрация сущности в мире.
- `BasketControlSystem` — сглаженное перемещение корзины к целевой X.
- `SpawnSystem` — спавн фруктов/хазардов с разными траекториями.
- `TrajectorySystem`, `MovementSystem`, `CleanupSystem`, `TimerSystem` — движение/время/уборка.
- `CollisionSystem` — ловля, урон, звуки, анимация попадания, всплывающий `ScorePopup`, бонус +1 за серию ловельных фруктов, сброс серии при промахе/хазарде.
- `SoundSystem` — фон (BGM) с автозапуском по жесту пользователя, SFX ловли и хазарда.
- `ScoreSystem` и `LivesSystem` — форматирование и обновление UI счёта и жизней (♥).
- `InputSystem` — подписки на мышь/тач, управление корзиной, запуск BGM.

UI:
- `GameOverUI` (`assets/scripts/ui/`) — показывает оверлей «Победа/Поражение», тап/клик перезапускает сцену.

---

## Поведение геймплея
- Фрукты при ловле дают своё значение + бонус +1 начиная со второго подряд; всплывающее число гаснет и поднимается вверх.
- Хазард наносит урон, сбрасывает серию, запускает свой SFX.
- Игровая сессия заканчивается при нуле жизней или окончании времени. Оверлей берёт текст из `GameState` и перезапускает сцену.

---

## Настройки и модификации
- Базовые параметры (скорости, интервалы, урон, очки) — `assets/scripts/core/game/GameConfig.ts`.
- Спавн/траектории — `SpawnSystem.ts` и `TrajectorySystem.ts`.
- Если нужно учитывать размер префаба при очистке «ниже экрана», скорректируйте `destroyWhenBelowY` в `SpawnSystem`.
- Поле `restartSceneName` в `GameOverUI` укажите, если имя текущей сцены пустое в рантайме (часто в Web Play Mode).

---

## Известные моменты
- BGM стартует только после пользовательского жеста (требование браузеров). Это делает `SoundSystem.startBackgroundIfNeeded()` через `InputSystem`.
- Коллизии упрощены (по позициям/ширине корзины); для точных столкновений можно перейти на 2D-коллайдеры Cocos.

---

## Использование AI
Часть начальной структуры создана с помощью ChatGPT и доработана в последствии вручную. 
